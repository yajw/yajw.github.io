{"pageProps":{"post":{"title":" feature toggle","comments":true,"date":"2021-02-17T00:00:00.000Z","tags":[],"categories":["总结"],"modifyTime":"2021-03-27 14:49:15 +0800","createTime":"2021-03-27 14:49:15 +0800","logs":[{"status":["A"],"files":["2021-03-27 feature toggle.md"],"abbrevHash":"f4f4061","hash":"f4f406175bde5279c552d8bac1c05cf7bb72d58e","subject":"Copy old posts","authorName":"yajw","authorDate":"2021-03-27 14:49:15 +0800"}],"link":"2021-03-27%20feature%20toggle","id":"50d786e2-a9cc-4948-bd4a-8b4b0c405a99","content":"<p>#feature swtich#\n#redis缓存刷新#</p>\n<p>默认缓存定期失效\n手动触发缓存失效\n可靠降级：缓存读不到，能够可靠降级到读db\n失效和超时由远端控制，避免出现本地脏读\n时间由远端定义\n方案1</p>\n<p>redis的超时机制，超时删除key\nvalue使用远端时间戳表示版本\n当读到时，对比和本地的版本，如果发现不一致，就读db刷新本地，然后更新本地版本\n当读不到时，尝试远程更新，用CAS方式刷新远程版本，注意一定避免并发导致的脏读\n降级：缓存时间不要太久，最好5分钟左右，减少故障损失\n远程更新失败：降级到读db\n方案2\n使用Redis的发布订阅功能\n问题：要保持长连接</p>\n"}},"__N_SSG":true}