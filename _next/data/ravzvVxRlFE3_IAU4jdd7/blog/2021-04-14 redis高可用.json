{"pageProps":{"post":{"tags":["redis"],"categories":["高可用"],"title":" redis高可用","modifyTime":"2021-04-14 16:35:20 +0800","createTime":"2021-04-14 17:13:20 +0800","logs":[{"status":["M"],"files":["\"2021-04-14 redis\\351\\253\\230\\345\\217\\257\\347\\224\\250.md\""],"abbrevHash":"4fb6e2d","hash":"4fb6e2d1e0ffd6ed567e78c0f6d7f9d52252f947","subject":"Update 2021-04-14 redis高可用.md","authorName":"yajw","authorDate":"2021-04-14 17:13:20 +0800"},{"status":["A"],"files":["\"2021-04-14 redis\\351\\253\\230\\345\\217\\257\\347\\224\\250.md\""],"abbrevHash":"fa18187","hash":"fa18187453e78652bd6072bdc46264c49bbffd96","subject":"Create 2021-04-14 redis高可用.md","authorName":"yajw","authorDate":"2021-04-14 16:35:20 +0800"}],"link":"2021-04-14%20redis%E9%AB%98%E5%8F%AF%E7%94%A8","id":"3d9dc190-553e-479c-a1e6-cc56efaeb52c","comments":false,"content":"<h1>高可用</h1>\n<p>官方的redis cluster通过gossip协议，特点</p>\n<ol>\n<li>分片提升扩展性：默认16384个slot，key分散hash</li>\n<li>gossip多复制，提升一致性和可用性</li>\n</ol>\n<p>redis sentinal能够做到故障发现，故障转移和切换，客户端通知</p>\n<p>分布式锁的一致性</p>\n<ul>\n<li>redlock方案：写多个独立的master，降低不一致概率</li>\n<li>Redis的wait命令能够支持写入到指定数量的replica后返回</li>\n<li>其他方案：参考微博的redrock结合rocksdb和Redis提供持久化和高性能，把高可用转移到mysql的方案上</li>\n</ul>\n<p><a href=\"https://tech.antfin.com/docs/2/~~/146758\">高性能分布式锁</a></p>\n<h1>其他</h1>\n<p>rehash</p>\n<p>热点key</p>\n<ul>\n<li>多级缓存（本地，远端多级）+多实例（slave），分散子key，lru</li>\n<li>更新：尽可能降低写频率，单线程，每秒写一次</li>\n</ul>\n<p>超时实现：维护TTL信息，访问时判断是否过期，如果是就删除，结合定期扫描删除。</p>\n"}},"__N_SSG":true}